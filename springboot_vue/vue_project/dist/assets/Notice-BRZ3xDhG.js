/* empty css             *//* empty css                *//* empty css              *//* empty css                *//* empty css               *//* empty css            *//* empty css               */import{r as U,b as B,c,a as m,d as l,u as R,J as z,f as I,w as r,i as J,M,L as O,o as _,j as p,O as q,x as y,t as T,R as $,E as A,e as F,Q as j,k as d}from"./index-Dz5qcgSE.js";import{r as f}from"./request-B6N1oStH.js";const L={class:"card",style:{"margin-bottom":"5px"}},P={class:"card",style:{"margin-bottom":"5px"}},Q={class:"card",style:{"margin-bottom":"5px"}},G={key:0},H={key:1},K={class:"dialog-footer",style:{padding:"0 0 0 0"}},se={__name:"Notice",setup(W){const g=U(),e=B({user:JSON.parse(localStorage.getItem("code_user")||"{}"),title:null,pageNum:1,pageSize:5,total:0,tableData:[],form:{},formVisible:!1,rules:{title:[{required:!0,message:"请输入公告标题",trigger:"blur"}],content:[{required:!0,message:"请输入公告内容",trigger:"blur"}]}}),n=()=>{f.get("/notice/selectPage",{params:{pageNum:e.pageNum,pageSize:e.pageSize,title:e.title}}).then(o=>{var t,s;o.code==="200"?(e.tableData=(t=o.data)==null?void 0:t.list,e.total=(s=o.data)==null?void 0:s.total):Element.error(o.msg)})};n();const V=()=>{e.form={},e.formVisible=!0},k=()=>{f.post("/notice/add",e.form).then(o=>{o.code==="200"?(d.success("新增成功"),e.formVisible=!1,n()):(d.error(o.msg),e.formVisible=!1)})},x=()=>{f.put("/notice/update",e.form).then(o=>{o.code==="200"?(d.success("更新成功"),e.formVisible=!1,n()):d.error(o.msg)})},E=()=>{g.value.validate(o=>{o&&(e.form.id?x():k())})},C=o=>{e.form=JSON.parse(JSON.stringify(o)),e.formVisible=!0},v=o=>{j.confirm("您确认要删除数据吗，删除后无法恢复","删除确认",{type:"warning"}).then(t=>{f.delete("/notice/delete/"+o).then(s=>{s.code==="200"?(d.success("删除成功"),console.log("删除成功"),n()):d.error(s.msg)})}).catch(t=>{})},w=()=>{e.title=null,n()};return(o,t)=>{const s=I,i=J,u=q,N=M,b=F,S=A,D=O;return _(),c("div",null,[m("div",L,[l(s,{clearable:"",onClear:n,style:{width:"240px"},modelValue:e.title,"onUpdate:modelValue":t[0]||(t[0]=a=>e.title=a),placeholder:"请输入title查询","prefix-icon":R(z)},null,8,["modelValue","prefix-icon"]),l(i,{type:"primary",onClick:n},{default:r(()=>t[5]||(t[5]=[p("查 询")])),_:1}),l(i,{onClick:w},{default:r(()=>t[6]||(t[6]=[p("重 置")])),_:1})]),m("div",P,[l(i,{type:"primary",onClick:V},{default:r(()=>t[7]||(t[7]=[p("新增")])),_:1})]),m("div",Q,[l(N,{data:e.tableData,style:{width:"100%"},"header-cell-style":{color:"#333",fontSize:"17px",backgroundColor:"#eaf4ff"}},{default:r(()=>[l(u,{prop:"title",label:"标题"}),l(u,{prop:"content",label:"内容"},{default:r(a=>[e.user.role==="USER"?(_(),c("span",G,T(a.row.content),1)):y("",!0),e.user.role==="USER"?(_(),c("span",H,"您暂无权限查看")):y("",!0)]),_:1}),l(u,{prop:"time",label:"时间"}),l(u,{label:"操作",width:"100"},$({_:2},[e.user.role==="ADMIN"?{name:"default",fn:r(a=>[l(i,{circle:"",icon:"Edit",type:"primary",onClick:h=>C(a.row)},null,8,["onClick"]),l(i,{circle:"",icon:"Delete",type:"danger",onClick:h=>v(a.row.id)},null,8,["onClick"])]),key:"0"}:void 0]),1024)]),_:1},8,["data"])]),m("div",null,[l(D,{modelValue:e.formVisible,"onUpdate:modelValue":t[4]||(t[4]=a=>e.formVisible=a),title:"公告信息",width:"500","destroy-on-close":""},{footer:r(()=>[m("div",K,[l(i,{onClick:t[3]||(t[3]=a=>e.formVisible=!1)},{default:r(()=>t[8]||(t[8]=[p("取消")])),_:1}),l(i,{type:"primary",onClick:E},{default:r(()=>t[9]||(t[9]=[p("确认")])),_:1})])]),default:r(()=>[l(S,{ref_key:"formRef",ref:g,rules:e.rules,"label-width":"80px",style:{padding:"20px 30px 0 0"},model:e.form},{default:r(()=>[l(b,{label:"公告标题",prop:"title"},{default:r(()=>[l(s,{placeholder:"请输入公告标题",modelValue:e.form.title,"onUpdate:modelValue":t[1]||(t[1]=a=>e.form.title=a),autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(b,{label:"公告内容",prop:"content"},{default:r(()=>[l(s,{type:"textarea",rows:3,placeholder:"请输入公告内容",modelValue:e.form.content,"onUpdate:modelValue":t[2]||(t[2]=a=>e.form.content=a),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue"])])])}}};export{se as default};
