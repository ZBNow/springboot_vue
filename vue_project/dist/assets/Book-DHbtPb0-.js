/* empty css             *//* empty css                *//* empty css                  *//* empty css                 *//* empty css                     *//* empty css                *//* empty css               *//* empty css            *//* empty css                     *//* empty css               *//* empty css              */import{b as h,e as U,c as q,a as f,f as l,u as z,N as D,h as I,w as t,k as T,Q as F,P as O,m as c,o as b,l as i,S as P,B as R,s as $,T as A,E as J,g as M,O as Q,p}from"./index-0MHbT1SH.js";const j={class:"card",style:{"margin-bottom":"5px"}},G={class:"card",style:{"margin-bottom":"5px"}},H={class:"card",style:{"margin-bottom":"5px"}},K={class:"dialog-footer",style:{padding:"0 0 0 0"}},ne={__name:"Book",setup(L){const g=h(),o=U({user:JSON.parse(localStorage.getItem("code_user")||"{}"),title:null,pageNum:1,pageSize:5,total:0,tableData:[],form:{},formVisible:!1,name:null,rules:{name:[{required:!0,message:"请输入图书名字",trigger:"blur"}],price:[{required:!0,message:"请输入图书价格",trigger:"blur"}],author:[{required:!0,message:"请输入图书作者",trigger:"blur"}],img:[{required:!0,message:"请输入图书封面",trigger:"blur"}]}}),n=()=>{c.get("/book/selectPage",{params:{pageNum:o.pageNum,pageSize:o.pageSize,name:o.name}}).then(a=>{var e,s;a.code==="200"?(o.tableData=(e=a.data)==null?void 0:e.list,o.total=(s=a.data)==null?void 0:s.total):Element.error(a.msg)})};n();const _=()=>{o.form={},o.formVisible=!0},V=()=>{c.post("/book/add",o.form).then(a=>{a.code==="200"?(p.success("新增成功"),o.formVisible=!1,n()):(p.error(a.msg),o.formVisible=!1)})},y=()=>{c.put("/book/update",o.form).then(a=>{a.code==="200"?(p.success("更新成功"),o.formVisible=!1,n()):p.error(a.msg)})},k=()=>{g.value.validate(a=>{a&&(o.form.id?y():V())})},w=()=>{o.title=null,n()},x=a=>{o.form.img=a.data},v=a=>{c.post("/borrow/add",a).then(e=>{e.code==="200"&&p.success("借阅成功")})};return(a,e)=>{const s=I,m=T,E=A,d=P,C=F,N=Q,u=M,B=J,S=O;return b(),q("div",null,[f("div",j,[l(s,{clearable:"",onClear:n,style:{width:"240px"},modelValue:o.name,"onUpdate:modelValue":e[0]||(e[0]=r=>o.name=r),placeholder:"请输入name查询","prefix-icon":z(D)},null,8,["modelValue","prefix-icon"]),l(m,{type:"primary",onClick:n},{default:t(()=>e[6]||(e[6]=[i("查 询")])),_:1}),l(m,{onClick:w},{default:t(()=>e[7]||(e[7]=[i("重 置")])),_:1})]),f("div",G,[l(m,{type:"primary",onClick:_},{default:t(()=>e[8]||(e[8]=[i("新增")])),_:1})]),f("div",H,[l(C,{data:o.tableData,style:{width:"100%"},"header-cell-style":{color:"#333",fontSize:"17px",backgroundColor:"#eaf4ff"}},{default:t(()=>[l(d,{label:"图书封面"},{default:t(r=>[r.row.img?(b(),R(E,{key:0,src:r.row.img,"preview-src-list":[r.row.img],"preview-teleported":!0,style:{width:"40px",height:"40px","border-radius":"50%",display:"block"}},null,8,["src","preview-src-list"])):$("",!0)]),_:1}),l(d,{prop:"name",label:"图书名字"}),l(d,{prop:"price",label:"图书价格"}),l(d,{prop:"author",label:"图书作者"}),l(d,{prop:"num",label:"剩余数量"}),l(d,{label:"操作",width:"100"},{default:t(r=>[l(m,{type:"primary",onClick:W=>v(r.row)},{default:t(()=>e[9]||(e[9]=[i("借阅")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),l(S,{modelValue:o.formVisible,"onUpdate:modelValue":e[5]||(e[5]=r=>o.formVisible=r),title:"公告信息",width:"500","destroy-on-close":""},{footer:t(()=>[f("div",K,[l(m,{onClick:e[4]||(e[4]=r=>o.formVisible=!1)},{default:t(()=>e[11]||(e[11]=[i("取消")])),_:1}),l(m,{type:"primary",onClick:k},{default:t(()=>e[12]||(e[12]=[i("确认")])),_:1})])]),default:t(()=>[l(B,{ref_key:"formRef",ref:g,rules:o.rules,"label-width":"80px",style:{padding:"20px 30px 0 0"},model:o.form},{default:t(()=>[l(u,{prop:"img",label:"图书封面"},{default:t(()=>[l(N,{action:"http://43.143.94.185:9999/files/upload",headers:{token:o.user.token},"on-success":x,"list-type":"picture"},{default:t(()=>[l(m,{type:"primary"},{default:t(()=>e[10]||(e[10]=[i("上传头像")])),_:1})]),_:1},8,["headers"])]),_:1}),l(u,{label:"图书名字",prop:"name"},{default:t(()=>[l(s,{modelValue:o.form.name,"onUpdate:modelValue":e[1]||(e[1]=r=>o.form.name=r),autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(u,{label:"图书价格",prop:"price"},{default:t(()=>[l(s,{modelValue:o.form.price,"onUpdate:modelValue":e[2]||(e[2]=r=>o.form.price=r),autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(u,{label:"图书作者",prop:"author"},{default:t(()=>[l(s,{modelValue:o.form.author,"onUpdate:modelValue":e[3]||(e[3]=r=>o.form.author=r),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue"])])}}};export{ne as default};
